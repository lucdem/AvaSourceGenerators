# AvaSourceGenerators
Source generators for AvaloniaUI boilerplate code.

## Example

At the moment only the StyledProperty generator is implemented. To use it, simply declare a class as partial and annotate a field with the AvaStyledProperty attribute:

```C#
using Avalonia.Controls.Primitives;
using Lucdem.Avalonia.SourceGenerators.Attributes;

namespace Lucdem.Avalonia.SourceGenerators.Sample.Controls;

public partial class LabeledButton : TemplatedControl
{
    public LabeledButton() { }

    [AvaStyledProperty]
    private string labelText = string.Empty;
}
```

The source generator will detect the attribute annotated field and create another partial class declaration with the basic StyledProperty boilerplate:

```C#
public static readonly StyledProperty<string> LabelTextProperty = AvaloniaProperty.Register<LabeledButton, string>("LabelText");

public string LabelText 
{ 
	get => GetValue(LabelTextProperty);
	set => SetValue(LabelTextProperty, value);
}
```

Well, or something equivalent to that at least. The exact output of the code generator is not exactly made for human eyes:

```C#
// <auto-generated/>
#pragma warning disable
#nullable enable
namespace Lucdem.Avalonia.SourceGenerators.Sample.Controls
{
    /// <inheritdoc/>
    partial class LabeledButton
    {
        public static readonly global::Avalonia.StyledProperty<string> LabelTextProperty = global::Avalonia.AvaloniaProperty.Register<LabeledButton, string>("LabelText");
        [global::System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverage]
        [global::System.CodeDom.Compiler.GeneratedCode("Lucdem.Avalonia.SourceGenerators.Generators.StyledPropertyGenerator", "0.1.0.0")]
        public string LabelText { get => GetValue(LabelTextProperty); set => SetValue(LabelTextProperty, value); }
    }
}
```

## How to use

The project is available as a [nuget package](https://www.nuget.org/packages/AvaSourceGenerators/).

## How to inspect generated source code in VisualStudio

After including the package, in the solution explorer, go to {YourProject}->Dependencies->Analyzers->Lucdem.Avalonia.SourceGenerators->{NameOfTheGenerator}.

## TODO list

* Add Diagnostics (warn user that the class should inherit from AvaloniaObject, that the annotated field must start with lower case character, etc)
* Add generators for attached and direct properties
* Maybe use field value as the default value for the property?
* Add a way to mark a function as the validation function for a property (something like a [AvaPropValidator(nameof(PropertyName))] annotation maybe?)